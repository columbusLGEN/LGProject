//
//  OrderTableViewCell.m
//  EasyChineseReading-ios
//
//  Created by 赵春阳 on 17/8/30.
//  Copyright © 2017年 lee. All rights reserved.
//

#import "UserOrderTableViewCell.h"

@interface UserOrderTableViewCell ()
@property (weak, nonatomic) IBOutlet UIView *viewBackground;  // 信息背景（为了边框）
@property (weak, nonatomic) IBOutlet UIView *coverLine;       // 虚线

@property (weak, nonatomic) IBOutlet UILabel *lblBookName;    // 书名
@property (weak, nonatomic) IBOutlet UILabel *lblBookCost;    // 钱
@property (weak, nonatomic) IBOutlet UILabel *lblAuthor;      // 作者

@property (weak, nonatomic) IBOutlet UIImageView *imgBookCoverPic; // 图书封面

@property (assign, nonatomic) ENUM_ZOrderState orderState;
@end

@implementation UserOrderTableViewCell

- (void)awakeFromNib {
    [super awakeFromNib];
    // Initialization code
    [self configOrderListTableViewCell];
}

- (void)setSelected:(BOOL)selected animated:(BOOL)animated {
    [super setSelected:selected animated:animated];

    // Configure the view for the selected state
}

- (void)configOrderListTableViewCell
{
    _lblBookName.textColor = [UIColor cm_blackColor_333333_1];
    _lblAuthor.textColor   = [UIColor cm_blackColor_666666_1];
    _lblBookCost.textColor = [UIColor cm_orangeColor_FF5910_1];
    
    _lblBookName.font = [UIFont systemFontOfSize:cFontSize_16];
    _lblAuthor.font   = [UIFont systemFontOfSize:cFontSize_14];
    _lblBookCost.font = [UIFont systemFontOfSize:cFontSize_12];
}

- (void)dataDidChange
{
    [self sizeToFit];
    OrderModel *order = self.data;
    BookModel *book = [BookModel mj_objectWithKeyValues:[order.books objectAtIndex:_index]];

    _lblBookName.text = book.bookName;
    _lblAuthor.text = [NSString stringWithFormat:@"%@: %@", LOCALIZATION(@"作者"), book.author];
    [_imgBookCoverPic sd_setImageWithURL:[NSURL URLWithString:book.iconUrl] placeholderImage:[UIImage imageNamed:@"img_book_placeholder"]];
    
    NSMutableAttributedString *price = [[NSMutableAttributedString alloc] initWithString:[NSString stringWithFormat:@"%@%ld", LOCALIZATION(@"¥"), (long)book.price]];
    NSRange upRange = NSMakeRange(1, price.length - 1);
    [price addAttribute:NSFontAttributeName value:[UIFont systemFontOfSize:_lblBookName.font.pointSize] range:upRange];
    _lblBookCost.attributedText = price;
    
    // 最后一本书, 虚线隐藏
//    _coverLine.hidden = _index == order.books.count;
//    if (_index < order.books.count - 1) {
        [UIView drawDashLine:_coverLine lineLength:3 lineSpacing:1 lineColor:[UIColor cm_lineColor_D9D7D7_1]];
//    }
}


@end
