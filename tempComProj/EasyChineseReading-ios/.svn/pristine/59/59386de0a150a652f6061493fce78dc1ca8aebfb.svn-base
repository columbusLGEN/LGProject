//
//  UCTeacherEditVC.m
//  EasyChineseReading-ios
//
//  Created by 赵春阳 on 2017/10/11.
//  Copyright © 2017年 retech. All rights reserved.
//

#import "UCTeacherEditVC.h"

@interface UCTeacherEditVC () <
UITextFieldDelegate>

@property (weak, nonatomic) IBOutlet UILabel *lblDescName;
@property (weak, nonatomic) IBOutlet UILabel *lblDescSex;
@property (weak, nonatomic) IBOutlet UILabel *lblDescAge;
@property (weak, nonatomic) IBOutlet UILabel *lblDescAccount;
@property (weak, nonatomic) IBOutlet UILabel *lblDescRemark;

@property (weak, nonatomic) IBOutlet UILabel *lblSex;
@property (weak, nonatomic) IBOutlet UILabel *lblName;
@property (weak, nonatomic) IBOutlet UILabel *lblAge;
@property (weak, nonatomic) IBOutlet UILabel *lblAccount;
@property (weak, nonatomic) IBOutlet UITextField *txtfRemark;

@end

@implementation UCTeacherEditVC

- (void)viewDidLoad {
    [super viewDidLoad];
    // Do any additional setup after loading the view.
    [self configView];
}

- (void)didReceiveMemoryWarning {
    [super didReceiveMemoryWarning];
    // Dispose of any resources that can be recreated.
}

#pragma mark - 配置界面

- (void)configView
{
    if (_canEdit) {
        [self configNavigationBar];
    }
    [self configTableView];
}

- (void)configTableView
{
    UIColor *descTextColor = [UIColor cm_blackColor_333333_1];
    UIColor *textColor = [UIColor cm_graryColor_807F7F_1];
    UIFont *font = [UIFont systemFontOfSize:16.f];
    
    _lblDescName.textColor      = descTextColor;
    _lblDescSex.textColor       = descTextColor;
    _lblDescAge.textColor       = descTextColor;
    _lblDescAccount.textColor   = descTextColor;
    _lblDescRemark.textColor    = descTextColor;
    
    _lblName.textColor      = textColor;
    _lblSex.textColor       = textColor;
    _lblAge.textColor       = textColor;
    _lblAccount.textColor   = textColor;
    _txtfRemark.textColor    = textColor;
    
    _lblDescName.font    = font;
    _lblDescSex.font     = font;
    _lblDescAge.font     = font;
    _lblDescAccount.font = font;
    _lblDescRemark.font  = font;
    
    _lblSex.font     = font;
    _lblName.font    = font;
    _lblAge.font     = font;
    _lblAccount.font = font;
    _txtfRemark.font  = font;
    
    _lblName.text = _teacher.name;
    _lblSex.text = _teacher.sex == ENUM_SexTypeMan ? @"男" : @"女";
    _lblAge.text = [NSString stringWithFormat:@"%ld", _teacher.age];
    _lblAccount.text = _teacher.phone.length > 0 ? _teacher.phone : _teacher.email;
    _txtfRemark.text = _teacher.remark;
}

- (void)configNavigationBar
{
    self.title = @"修改教师";
    self.navigationItem.rightBarButtonItem = [[UIBarButtonItem alloc] initWithTitle:@"保存" style:UIBarButtonItemStylePlain target:self action:@selector(saveTeacherInfo)];
}

#pragma mark - 保存

- (void)saveTeacherInfo
{
    [[ClassRequest sharedInstance] updateTeacherWithType:ENUM_UpdateTypeUp teacherId:_teacher.userId remark:_txtfRemark.text completion:^(id object, ErrorModel *error) {
        if (error) {
            [self presentFailureTips:error.message];
        }
        else {
            _teacher.remark = _txtfRemark.text;
            self.updateTeacherSuccess(_teacher);
            [self.navigationController popViewControllerAnimated:YES];
        }
    }];
}

#pragma mark - UITextFieldDelegate

- (BOOL)textFieldShouldBeginEditing:(UITextField *)textField
{
    return _canEdit;
}

@end
