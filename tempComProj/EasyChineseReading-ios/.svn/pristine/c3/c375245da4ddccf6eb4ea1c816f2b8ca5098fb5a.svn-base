//
//  FirstLaunchCountryVC.m
//  EasyChineseReading-ios
//
//  Created by 赵春阳 on 2017/11/22.
//  Copyright © 2017年 retech. All rights reserved.
//

#import "FirstLaunchCountryVC.h"

#import "UserInfoAddressVC.h"
#import "FirstLaunchBirthdayVC.h"
#import "ECRLocationManager.h"

@interface FirstLaunchCountryVC ()

@property (strong, nonatomic) UIImageView *imgBackground;
@property (strong, nonatomic) UILabel     *lblCountry;
@property (strong, nonatomic) UIButton    *btnNext;

@end

@implementation FirstLaunchCountryVC

- (void)viewDidLoad {
    [super viewDidLoad];
    self.navigationController.navigationBar.hidden = YES;
    [ECRLocationManager rg_startUpdatingLocationWithBlock:^(NSString *country) {
        [self configCountryViewWithCountry:country];
    }];
}

- (void)didReceiveMemoryWarning {
    [super didReceiveMemoryWarning];
    // Dispose of any resources that can be recreated.
}

- (void)configCountryViewWithCountry:(NSString *)country
{
    _imgBackground = [UIImageView new];
    _imgBackground.image = [UIImage imageNamed:@"img_background_about"];
    [self.view addSubview:_imgBackground];
    
    _lblCountry = [UILabel new];
    _lblCountry.textColor = [UIColor cm_blackColor_666666_1];
    _lblCountry.font = [UIFont systemFontOfSize:cFontSize_18];
    _lblCountry.text = country;
    _lblCountry.userInteractionEnabled = YES;
    [self.view addSubview:_lblCountry];
    
    UITapGestureRecognizer *tap = [[UITapGestureRecognizer alloc] initWithTarget:self action:@selector(toSelectCountry)];
    [_lblCountry addGestureRecognizer:tap];
    
    _btnNext = [[UIButton alloc] initWithFrame:CGRectMake(0, 0, self.view.width - 86*2, cButtonHeight_40)];
    _btnNext.backgroundColor = [UIColor cm_yellowColor_FFE402_1];
    _btnNext.titleLabel.font = [UIFont systemFontOfSize:cFontSize_16];
    _btnNext.titleLabel.textColor = [UIColor whiteColor];
    _btnNext.layer.cornerRadius  = _btnNext.height/2;
    _btnNext.layer.masksToBounds = YES;
    [_btnNext setTitle:LOCALIZATION(@"Next") forState:UIControlStateNormal];
    [_btnNext setTitleColor:[UIColor whiteColor] forState:UIControlStateNormal];
    [_btnNext addTarget:self action:@selector(toSelectedBirthday) forControlEvents:UIControlEventTouchUpInside];
    [self.view addSubview:_btnNext];
    
    [_imgBackground mas_makeConstraints:^(MASConstraintMaker *make) {
        make.edges.mas_equalTo(UIEdgeInsetsZero);
    }];
    [_lblCountry mas_makeConstraints:^(MASConstraintMaker *make) {
        make.centerX.mas_equalTo(self.view.mas_centerX);
        make.centerY.mas_equalTo(self.view.mas_centerY);
        
    }];
    [_btnNext mas_makeConstraints:^(MASConstraintMaker *make) {
        make.centerX.mas_equalTo(self.view.mas_centerX);
        make.bottom .mas_equalTo(self.view.mas_bottom).offset(-cHeaderHeight_44);
        make.size   .mas_equalTo(CGSizeMake(self.view.width - 86*2, cButtonHeight_40));
    }];
}

- (void)toSelectCountry
{
    UserInfoAddressVC *addressVC = [[UserInfoAddressVC alloc] init];
    addressVC.language = ENUM_LanguageTypeEnglish;
    addressVC.selectedCountryBlock = ^(CountryModel * country){
        _lblCountry.text = country.en_name;
    };
    [self.navigationController pushViewController:addressVC animated:YES];
}

- (void)toSelectedBirthday
{
    FirstLaunchBirthdayVC *birthdayVC = [FirstLaunchBirthdayVC new];
    [self.navigationController pushViewController:birthdayVC animated:YES];
}

@end
