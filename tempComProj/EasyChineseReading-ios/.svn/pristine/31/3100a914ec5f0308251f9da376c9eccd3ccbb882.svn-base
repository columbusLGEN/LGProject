//
//  UOrderFooterView.m
//  EasyChineseReading-ios
//
//  Created by 赵春阳 on 17/9/4.
//  Copyright © 2017年 lee. All rights reserved.
//

#import "UserOrderFooterView.h"

@interface UserOrderFooterView ()

@property (strong, nonatomic) IBOutlet UIButton *btnLeft;
@property (strong, nonatomic) IBOutlet UIButton *btnRight;
@property (strong, nonatomic) IBOutlet UILabel *lblMoney;
@property (strong, nonatomic) IBOutlet UIView *viewLine;

@property (strong, nonatomic) OrderModel *order;

@end

@implementation UserOrderFooterView


- (void)drawRect:(CGRect)rect
{
    [super drawRect:rect];
}

- (void)awakeFromNib
{
    [super awakeFromNib];
    [self configDefaultOrderFooterView];
}

- (void)configDefaultOrderFooterView
{
    _btnLeft.layer.masksToBounds = YES;
    _btnLeft.layer.cornerRadius = _btnLeft.height/2;
    
    _btnLeft.layer.borderWidth = 1.f;
    _btnLeft.layer.borderColor = [UIColor cm_purpleColor_82056B_1].CGColor;
    _btnLeft.backgroundColor = [UIColor whiteColor];
    _btnLeft.tintColor = [UIColor cm_purpleColor_82056B_1];
    [_btnLeft setTitle:@"取消订单" forState:UIControlStateNormal];
    _btnLeft.hidden = YES;
    
    _btnRight.layer.masksToBounds = YES;
    _btnRight.layer.cornerRadius = _btnRight.height/2;
    
    _btnRight.layer.borderWidth = 1.f;
    _btnRight.layer.borderColor = [UIColor cm_purpleColor_82056B_1].CGColor;
    _btnRight.backgroundColor = [UIColor whiteColor];
    _btnRight.tintColor = [UIColor cm_purpleColor_82056B_1];
    [_btnRight setTitle:@"评价" forState:UIControlStateNormal];
    
    _viewLine.backgroundColor = [UIColor cm_lineColor_E3E3E3_1];
    
    _lblMoney.textColor = [UIColor cm_orangeColor_FF6000_1];
    _lblMoney.font = [UIFont systemFontOfSize:16.f];
}

#pragma mark -
#pragma mark 数据更新


- (void)dataDidChange
{
    _order = self.data;
    NSString *string = [NSString stringWithFormat:@"合计: %@%@", @"￥", _order.price];
    NSMutableAttributedString *money = [[NSMutableAttributedString alloc] initWithString:string];
    //获取要调整颜色的文字位置,调整颜色
    NSRange range = [[money string] rangeOfString:@" "];
    NSRange upRang = NSMakeRange(range.location, string.length - range.location - range.length + 1);
    [money addAttribute:NSFontAttributeName value:[UIFont systemFontOfSize:20.f] range:upRang];
    _lblMoney.attributedText = money;
    // ----- 9.25 zcy 拉取订单状态全部改为 已支付
//    if (_order.orderStatus == ENUM_ZOrderStateObligation) {    // 待付款
//        _btnRight.backgroundColor = [UIColor cm_purpleColor_82056B_1];
//        _btnRight.tintColor = [UIColor whiteColor];
//        [_btnRight setTitle:@"立即付款" forState:UIControlStateNormal];
//    }
//    else {
//        if (_order.orderStatus == ENUM_ZOrderStateScore) { // 待评价
//            _btnRight.layer.borderWidth = 1.f;
//            _btnRight.layer.borderColor = [UIColor cm_purpleColor_82056B_1].CGColor;
//            _btnRight.backgroundColor = [UIColor whiteColor];
//            _btnRight.tintColor = [UIColor cm_purpleColor_82056B_1];
//            [_btnRight setTitle:@"评价" forState:UIControlStateNormal];
//        }
//    }
    
//    _btnLeft.hidden = _order.orderStatus != ENUM_ZOrderStateObligation; // 除待付款 不显示
    // -----

//    _viewLine.hidden = _order.orderStatus == ENUM_ZOrderStateDone; // 除完成订单 都显示
    if (_isDetailFooter) {
        _viewLine.hidden = YES;
    }
}

#pragma mark -
#pragma mark action

- (IBAction)click_btnLeft:(id)sender {
    // ----- 9.25
//    [self cancelOrder];
    // -----
}

- (IBAction)click_btnRight:(id)sender {
    OrderModel *order = self.data;
    // ----- 9.25
//    if (order.orderStatus == ENUM_ZOrderStateObligation) {
//        [self payOrder];
//    }
//    else
    // -----
    if (order.orderStatus == ENUM_ZOrderStateScore) {
        [self evaluate];
    }
}
// ----- 9.25
//
///**
// 取消订单
// */
//- (void)cancelOrder
//{
//    if ([self.delegate respondsToSelector:@selector(cancelOrderWithOrderId:)]) {
//        [self.delegate cancelOrderWithOrderId:_order.orderId];
//    }
//}
//
///**
// 支付订单
// */
//- (void)payOrder
//{
//    if ([self.delegate respondsToSelector:@selector(payOrderWithOrderId:)]) {
//        [self.delegate payOrderWithOrderId:_order.orderId];
//    }
//}
// -----

/**
 评价
 */
- (void)evaluate
{
    if ([self.delegate respondsToSelector:@selector(evaluateWithOrderId:)]) {
        [self.delegate evaluateWithOrderId:_order.orderId];
    }
}

@end
