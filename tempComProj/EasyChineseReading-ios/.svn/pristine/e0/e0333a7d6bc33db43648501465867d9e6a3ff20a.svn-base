//
//  UOrderDetailTableViewCell.m
//  EasyChineseReading-ios
//
//  Created by 赵春阳 on 2017/10/10.
//  Copyright © 2017年 retech. All rights reserved.
//

#import "UOrderDetailTableViewCell.h"

@interface UOrderDetailTableViewCell()<ZStarViewDelegate>

@property (weak, nonatomic) IBOutlet UIView *viewStar;          // 图书评价
@property (weak, nonatomic) IBOutlet UIView *viewBackground;    // 背景(设置边框)
@property (weak, nonatomic) IBOutlet UIView *viewLine;          // 横线

@property (weak, nonatomic) IBOutlet UIImageView *imgBookCover; // 图书封面

@property (weak, nonatomic) IBOutlet UILabel *lblDescScore;     // 描述: 商品评价
@property (weak, nonatomic) IBOutlet UILabel *lblBookName;      // 图书名
@property (weak, nonatomic) IBOutlet UILabel *lblBookAuthor;    // 作者
@property (weak, nonatomic) IBOutlet UILabel *lblBookPrice;     // 价格

@property (nonatomic, weak) BookModel *book; // 图书

@end

@implementation UOrderDetailTableViewCell

- (void)awakeFromNib {
    [super awakeFromNib];
    [self configOrderDetailCell];
}

- (void)setSelected:(BOOL)selected animated:(BOOL)animated {
    [super setSelected:selected animated:animated];

    // Configure the view for the selected state
}

- (void)configOrderDetailCell
{
    _viewBackground.layer.borderColor = [UIColor cm_lineColor_E3E3E3_1].CGColor;
    _viewBackground.layer.borderWidth = 1.f;
    
    _viewLine.backgroundColor = [UIColor cm_lineColor_E3E3E3_1];
    
    _lblDescScore.textColor  = [UIColor cm_blackColor_333333_1];
    _lblBookName.textColor   = [UIColor cm_blackColor_333333_1];
    _lblBookAuthor.textColor = [UIColor cm_graryColor_807F7F_1];
    _lblBookPrice.textColor  = [UIColor cm_orangeColor_BB7435_1];
}

- (void)dataDidChange
{
    _book = self.data;
    if (![_book isKindOfClass:[BookModel class]]) {
        return;
    }
    
    _lblBookName.text = _book.NAME;
    _lblBookAuthor.text = [NSString stringWithFormat:@"作者: %@", _book.author];
    _lblBookPrice.text = [NSString stringWithFormat:@"%@%.2f", @"¥", _book.price];
    
    [_imgBookCover sd_setImageWithURL:[NSURL URLWithString:@"image"] placeholderImage:[UIImage imageNamed:@"1"]];
    
    ZStarView *starView = [[ZStarView alloc] initWithFrame:_viewStar.bounds numberOfStar:5];
    starView.delegate = self;
    starView.canChange = _book.userScore == 0;
    [starView setScore:_book.userScore withAnimation:NO];
    [_viewStar addSubview:starView];
}

#pragma mark -
#pragma mark ZStarViewDelegate

- (void)starRatingView:(ZStarView *)view score:(float)score
{
    [self.delegate updateScoreWithScore:score bookId:_book.bookId orderDetailId:_book.orderDetailId];
}

@end
