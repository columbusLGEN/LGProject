//
//  TaskRequest.m
//  EasyChineseReading-ios
//
//  Created by 赵春阳 on 2017/9/18.
//  Copyright © 2017年 retech. All rights reserved.
//

#import "TaskRequest.h"

@implementation TaskRequest

CM_SINGLETON_IMPLEMENTION(TaskRequest)


#pragma mark - 我的任务接口

/**
 我的任务
 
 @param completion 回调
 */
- (void)getTaskListWithCompletion:(CompleteBlock)completion
{
    NSDictionary *dic = @{@"params": @{@"userId": [NSString stringWithFormat:@"%ld", [UserRequest sharedInstance].user.userId],
                                       },
                          @"md5"   : @"654c01acaf40e0ce6d841a552fd3b96c"};
    [ZNetworkRequest requestWithHttpMethod:ENUM_ZHttpRequestMethodPost
                                    strUrl:@"task/queryTaskStatus"
                                parameters:dic
                             completeBlock:^(id responseObject, ErrorModel *error) {
                                 if (error) {
                                     completion(nil, error);
                                 }
                                 else {
                                     
                                     completion(responseObject, nil);
                                 }
                             }];
}

#pragma mark - 读书任务

/**
 读书任务
 
 @param page        页数
 @param completion  回调
 */
- (void)getReadTaskWithPage:(NSString *)page
                 completion:(CompleteBlock)completion
{
    NSDictionary *dic = @{@"params": @{@"userId": [NSString stringWithFormat:@"%ld", [UserRequest sharedInstance].user.userId],
                                       @"page"  : page,
                                       @"length": [NSString stringWithFormat:@"%ld", cListNumber_10]
                                       },
                          @"md5"   : @"654c01acaf40e0ce6d841a552fd3b96c"};
    [ZNetworkRequest requestWithHttpMethod:ENUM_ZHttpRequestMethodPost
                                    strUrl:@"task/selectRecomAndAuthTask"
                                parameters:dic
                             completeBlock:^(id responseObject, ErrorModel *error) {
                                 if (error) {
                                     completion(nil, error);
                                 }
                                 else {
                                     
                                     completion(responseObject, nil);
                                 }
                             }];
}

#pragma mark - 查询任务状态

/**
 查询任务状态
 
 @param taskType   类型(1 每日 2 长期 3 一次性 0 全部)
 @param completion 回调
 */
- (void)getTaskStatusWithTaskType:(NSString *)taskType
                       completion:(CompleteBlock)completion
{
    NSDictionary *dic = @{@"params": @{@"userId"  : [NSString stringWithFormat:@"%ld", [UserRequest sharedInstance].user.userId],
                                       @"taskType": taskType,
                                       },
                          @"md5"   : @"654c01acaf40e0ce6d841a552fd3b96c"};
    [ZNetworkRequest requestWithHttpMethod:ENUM_ZHttpRequestMethodPost
                                    strUrl:@"task/selectTask"
                                parameters:dic
                             completeBlock:^(id responseObject, ErrorModel *error) {
                                 if (error) {
                                     completion(nil, error);
                                 }
                                 else {
                                     
                                     completion(responseObject, nil);
                                 }
                             }];
}

#pragma mark - 领取任务奖励

/**
 领取任务奖励
 
 @param task        任务
 @param completion  回调
 */
- (void)getTaskAwardWithTask:(TaskModel *)task
                  completion:(CompleteBlock)completion
{
    NSDictionary *dic = @{@"params": @{@"userId"       : [NSString stringWithFormat:@"%ld", [UserRequest sharedInstance].user.userId],
                                       @"taskDetailId" : [NSString stringWithFormat:@"%ld", task.taskDetailId],
                                       @"taskType"     : [NSString stringWithFormat:@"%ld", task.tasktype],
                                       @"award"        : [NSString stringWithFormat:@"%ld", task.taskreward]
                                       },
                          @"md5"   : @"654c01acaf40e0ce6d841a552fd3b96c"};
    [ZNetworkRequest requestWithHttpMethod:ENUM_ZHttpRequestMethodPost
                                    strUrl:@"task/receiveRewards"
                                parameters:dic
                             completeBlock:^(id responseObject, ErrorModel *error) {
                                 if (error) {
                                     completion(nil, error);
                                 }
                                 else {
                                     completion(responseObject, nil);
                                 }
                             }];
}

@end
