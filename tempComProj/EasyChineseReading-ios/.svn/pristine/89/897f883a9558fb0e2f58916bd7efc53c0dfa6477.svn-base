//
//  UTaskVC.m
//  EasyChineseReading-ios
//
//  Created by 赵春阳 on 17/8/30.
//  Copyright © 2017年 lee. All rights reserved.
//

#import "UserTaskVC.h"

#import "UTaskTableViewCell.h"
#import "ZSlideSwitch.h"

#import "UTaskSystemVC.h"
#import "UTaskReadingVC.h"

@interface UserTaskVC ()<ZSlideSwitchDelegate>

@property (strong, nonatomic) ZSlideSwitch *slideSwitch;     /** 滑动切换条 */
@property (strong, nonatomic) UTaskReadingVC *taskReadingVC; /** 读书任务 */
@property (strong, nonatomic) UIButton *btnLeft;             /** 左侧按键-系统任务 */
@property (strong, nonatomic) UIButton *btnRight;            /** 右侧按键-读书人物 */
@property (nonatomic, strong) NSMutableArray *arrTasks;      /** 控制器集合 */

@end

@implementation UserTaskVC

- (void)viewDidLoad {
    [super viewDidLoad];
    [self configTaskView];
}

- (void)didReceiveMemoryWarning {
    [super didReceiveMemoryWarning];
    // Dispose of any resources that can be recreated.
}

#pragma mark -
#pragma mark SlideSwitchDelegate

- (void)slideSwitchDidselectAtIndex:(NSInteger)index {
    
}

#pragma mark -
#pragma mark 配置界面

- (void)configTaskView
{
    self.title = @"我的任务";
    
    UIView *topView = [[UIView alloc] initWithFrame:CGRectMake(0, 0, Screen_Width, cHeaderHeight_44)];
    topView.backgroundColor = [UIColor whiteColor];
    
    _btnLeft = [[UIButton alloc] initWithFrame:CGRectMake(0, 0, Screen_Width/2 - 1, cHeaderHeight_44 - 1)];
    [_btnLeft setTitle:@"系统任务" forState:UIControlStateNormal];
    [_btnLeft.titleLabel setFont:[UIFont systemFontOfSize:16.f]];
    [_btnLeft setTitleColor:[UIColor cm_blackColor_333333_1] forState:UIControlStateNormal];
    [_btnLeft setTitleColor:[UIColor cm_purpleColor_82056B_1] forState:UIControlStateSelected];
    [_btnLeft setBackgroundColor:[UIColor clearColor]];
    [_btnLeft addTarget:self action:@selector(selectedSystemTask) forControlEvents:UIControlEventTouchUpInside];
    [_btnLeft setSelected:YES];
    
    _btnRight = [[UIButton alloc] initWithFrame:CGRectMake(Screen_Width/2, 0, Screen_Width/2, cHeaderHeight_44 - 1)];
    [_btnRight setTitle:@"读书任务" forState:UIControlStateNormal];
    [_btnRight.titleLabel setFont:[UIFont systemFontOfSize:16.f]];
    [_btnRight setTitleColor:[UIColor cm_blackColor_333333_1] forState:UIControlStateNormal];
    [_btnRight setTitleColor:[UIColor cm_purpleColor_82056B_1] forState:UIControlStateSelected];
    [_btnRight setBackgroundColor:[UIColor clearColor]];
    [_btnRight addTarget:self action:@selector(selectedReadingTask) forControlEvents:UIControlEventTouchUpInside];
    
    UIView *vericalLineView = [[UIView alloc] initWithFrame:CGRectMake(Screen_Width/2 - 1, 10, .5, 24)];
    vericalLineView.backgroundColor = [UIColor cm_lineColor_E3E3E3_1];
    
    UIView *bottomLineView = [[UIView alloc] initWithFrame:CGRectMake(0, topView.height - 0.5, Screen_Width, 0.5)];
    bottomLineView.backgroundColor = [UIColor cm_lineColor_E3E3E3_1];
    
    [topView addSubview:_btnLeft];
    [topView addSubview:_btnRight];
    [topView addSubview:vericalLineView];
    [topView addSubview:bottomLineView];
    
    [self.view addSubview:topView];
    
    [self configReadingTask];
    [self configSystemTask];
}

#pragma mark -
#pragma mark 展示系统任务 读书任务

/* 系统任务 */
- (void)configSystemTask {
    //要显示的标题
    NSArray *titles = @[@"每日任务", @"长期任务"];
    //创建需要展示的ViewController
    NSMutableArray *arrViewControllers = [[NSMutableArray alloc] init];
    
    for (NSInteger i = 0; i < titles.count; i ++) {
        UTaskSystemVC *systemVC = [UTaskSystemVC new];
        systemVC.taskType = i;
        [arrViewControllers addObject:systemVC];
    }
    
    //创建滚动视图
    _slideSwitch = [[ZSlideSwitch alloc] initWithFrame:CGRectMake(0, cHeaderHeight_44, Screen_Width, self.view.height - cHeaderHeight_44) titles:titles viewControllers:arrViewControllers canScroll:NO needCenter:YES];
    //设置代理
    _slideSwitch.delegate = self;
    //设置按钮选中和未选中状态的标题颜色
    _slideSwitch.selectedColor = [UIColor cm_mainColor];
    _slideSwitch.normalColor = [UIColor cm_blackColor_333333_1];
    //显示方法
    [_slideSwitch showInViewController:self];
}

/* 读书任务 */
- (void)configReadingTask {
    _taskReadingVC = [[UTaskReadingVC alloc] init];
    _taskReadingVC.view.frame = CGRectMake(0, cHeaderHeight_44, Screen_Width, self.view.height - 2*cHeaderHeight_44);
    
    [self addChildViewController:_taskReadingVC];
    [self.view addSubview:_taskReadingVC.view];
}

#pragma mark -
#pragma mark 切换任务类型
/* 系统任务 */
- (void)selectedSystemTask
{
    [_btnLeft setSelected:YES];
    [_btnRight setSelected:NO];
    [self.view bringSubviewToFront:_slideSwitch];
}
/* 看书任务 */
- (void)selectedReadingTask
{
    [_btnLeft setSelected:NO];
    [_btnRight setSelected:YES];
    [self.view bringSubviewToFront:_taskReadingVC.view];
}

@end
